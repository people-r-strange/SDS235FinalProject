---
title: "WildFire Tracker"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    social: menu
    theme: bootstrap
runtime: shiny
---

```{r include=FALSE}
library(shiny)
library(leaflet) # devtools::install_github('rstudio/leaflet')
library(highcharter) # devtools::install_github('jbkunst/highcharter')
library(plotly) # devtools::install_github('ropensci/plotly')
library(ggplot2) # devtools::install_github('hadley/ggplot2')
library(sp)
library(dplyr)
library(flexdashboard) # devtools::install_github('rstudio/flexdashboard')
library(rgeos)
library(mapproj)
library(maptools)
library(readr)
library(ggthemes)
library(tigris)

# Read in data, and subset for the selected metro
#full_tracts <- readRDS('full_simp2.rds')
wildfires <- read_csv("C:/Users/igome/Documents/Smith/Spring_2021/visual analyticsd/Final Project/FW_Veg_Rem_Combined.csv")
states <- states(cb = TRUE)
map <- reactive({
  m <- states %>%
    filter(STUSPS == input$variable)
  return(m)
})
```



States
=======================================================================

Sidebar {.sidebar}
----------------------------------------------------------------------

```{r}
#Define inputs for Drop Down Menu
 selectInput( "variable", "Select a State:",
              c("Alabama" = "AL",
              "Alaska" = "AK",
              "Arizona" = "AZ",
              "Arkansas" = "AR",
              "California" = "CA",
              "Colorado" = "CO",
              "Connecticut" = "CT",
              "Delaware" = "DE",
              "Florida" = "FL",
              "Georgia" = "GA",
              "Hawaii" = "HI",
              "Idaho" = "ID",
              "Illiois" = "IL",
              "Indiana" = "IN",
              "Iowa" = "IA",
              "Kansas" = "KS",
              "Kentucky" = "KY",
              "Louisiana" = "LA",
              "Maine" = "ME",
              "Maryland" = "MD",
              "Massachusetts" = "MA",
              "Michigan" = "MI",
              "Minnesota" = "MN",
              "Mississippi" = "MS",
              "Missouri" = "MO",
              "Montana" = "MT",
              "Nebraska" = "NE",
              "Nevada" = "NV",
              "New Hampshire" = "NH",
              "New Jersey" = "NJ",
              "New Mexico" = "NM",
              "New York" = "NY",
              "North Carolina" = "NC",
              "North Dakota" = "ND",
              "Ohio" = "OH",
              "Oklahoma" = "OK",
              "Oregon" = "OR",
              "Pennsylvania" = "PA",
              "Puerto Rico" = "PR",
              "Rhode Island" = "RI",
              "South Carolina" = "SC",
              "South Dakota" = "SD",
              "Tennessee" = "TN",
              "Texas" = "TX",
              "Utah" = "UT",
              "Vermont" = "VT",
              "Arkansas" = "AR",
              "Virginia" = "VA",
              "Washington" = "WA",
              "West Virginia" = "WV",
              "Wisconsin" = "WI",
              "Wyoming" = "WY"))

```

### Introduction

Row
-----------------------------------------------------------------------

### Fire Distribution

```{r}
#Insert Code for US Fire Distribution Map Here
# Draw the map without selected tracts


iconsL <- reactive({
  iconsL <- makeAwesomeIcon(
  icon = 'flame',
  iconColor = 'black',
  library = 'ion',
  markerColor = "red"
)
})

iconsM <- reactive({
  iconsM <- makeAwesomeIcon(
  icon = 'flame',
  iconColor = 'black',
  library = 'ion',
  markerColor = "orange"
)
})

iconsS <- reactive({
  iconsS <- makeAwesomeIcon(
  icon = 'flame',
  iconColor = 'black',
  library = 'ion',
  markerColor = "blue"
)
})

firesL <- reactive({
  firesL <- wildfires %>%
    filter(state == input$variable) %>%
    filter(fire_size_class == "F" | fire_size_class == "G")
  return(firesL)
})

firesM <- reactive({
  firesM <- wildfires %>%
    filter(state == input$variable) %>%
    filter(fire_size_class == "D" | fire_size_class == "E")
  return(firesM)
})

firesS <- reactive({
  firesS <- wildfires %>%
    filter(state == input$variable) %>%
    filter(fire_size_class == "B" | fire_size_class == "C")
  return(firesS)
})
output$map <- renderLeaflet({
    
    leaflet_map <- leaflet(map()) %>%
      addProviderTiles('CartoDB.Positron') %>%
      addPolygons(fillColor = "white",
              color = "black",
              weight = 0.5) %>%
  setView(-98.5795, 39.8282, zoom=3) %>%
  addTiles() %>%
      addAwesomeMarkers(~firesL()$longitude, ~firesL()$latitude, icon = iconsL(), 
                  popup = paste("Cause:", firesL()$stat_cause_descr, "<br>",
                           "Size:", firesL()$fire_size, "acres", "<br>",
                           "Date Discovered:", firesL()$disc_clean_date), group = "Large") %>%
  addAwesomeMarkers(~firesM()$longitude, ~firesM()$latitude, icon = iconsM(), 
                  popup = paste("Cause:", firesM()$stat_cause_descr, "<br>",
                           "Size:", firesM()$fire_size, "acres", "<br>",
                           "Date Discovered:", firesM()$disc_clean_date), group = "Medium") %>%
    addAwesomeMarkers(~firesS()$longitude, ~firesS()$latitude, icon = iconsS(), 
                  popup = paste("Cause:", firesS()$stat_cause_descr, "<br>",
                           "Size:", firesS()$fire_size, "acres", "<br>",
                           "Date Discovered:", firesS()$disc_clean_date), group = "Small") %>%
  addLayersControl(overlayGroups = c("Large", "Medium", "Small"), options = layersControlOptions(collapsed = FALSE))
    
    leaflet_map
    
  })
leafletOutput('map')  

```


### Fire Size by Census Tract
```{r}
#Insert Code for US Fire Size by Census Tract Map Here
```

Data Visualizations
=======================================================================
Row
-----------------------------------------------------------------------
### Data Viz #1
```{r}
#Insert code for data viz #1
```

### Data Viz #2
```{r}
#Insert code for data viz #2
```
### Data Viz #3
```{r}
#Insert code for data viz #3
```
### Data Viz #4
```{r}
#Insert code for data viz #4
```

Row
-----------------------------------------------------------------------
### Data Viz #5

```{r}

```

What is an Acre? 
=======================================================================

Row {.tabset .tabset-fade}
-------------------------------------
### **5 acres**

**Fire Class B**

One city block is about **5 acres**

![Example of a City Block](city-block.png) 

### **15 acres**

**Fire Class C**

Ground Zero 

(where the Twin Towers used to be)

was **14.6 acres** 

![Ground Zero](zero.png) 

### **150 acres** 

**Fire Class D** 

Roosevelt Island is 

a little less than **150 acres**

![Roosevelt Island](koroo.png) 

### **850 acres**

**Fire Class E** 

Central Park is 

**842.6 acres** 

![Central Park, NY](Central-Park.png) 

### **3,000 acres** 

**Fire Class F** 

East Harlem, New York

is a little less than **3,000 acres**

![East Harlem, NY](east-harlem.png) 

### **10,000 acres**

**Fire Class G**

The borough of Manhattan is a little over **10,000 acres** large

![Manhattan, NY](mahattan.png)


About
=======================================================================

**Notes:**

* This sample and accompanying visualizations do not include any fires that are class A (<0.25 acres)

**Original Dataset**

* https://www.kaggle.com/capcloudcoder/us-wildfire-data-plus-other-attributes?select=Wildfire_att_description.txt




